# src/ui/components/file_selector.py
"""File selector widget implementation."""
from PySide6.QtWidgets import (
    QFrame, QVBoxLayout, QHBoxLayout, QLabel,
    QLineEdit, QPushButton, QFileDialog
)
from PySide6.QtCore import Signal, Qt
from PySide6.QtGui import QFont
from pathlib import Path
from typing import Optional, List

from src.ui.theme.manager import HungerRushTheme

class FileSelector(QFrame):
    """Widget for file/directory selection."""
    
    path_changed = Signal(str)  # Emitted when path changes

    def __init__(
        self,
        title: str,
        is_file: bool = True,
        file_types: Optional[List[str]] = None,
        default_path: Optional[str] = None,
    ):
        """Initialize the file selector.
        
        Args:
            title: Title displayed above the selector
            is_file: True for file selection, False for directory
            file_types: List of allowed file extensions (for files only)
            default_path: Initial path to display
        """
        super().__init__()
        self.is_file = is_file
        self.file_types = file_types
        self._setup_ui(title, default_path)

    def _setup_ui(self, title: str, default_path: Optional[str]) -> None:
        """Set up the user interface."""
        layout = QVBoxLayout(self)
        layout.setSpacing(10)

        # Title
        title_label = QLabel(title)
        title_label.setFont(QFont(
            HungerRushTheme.STYLES["font_family"],
            HungerRushTheme.STYLES["font_size"]
        ))
        title_label.setStyleSheet(
            f"color: {HungerRushTheme.COLORS['label_color']};"
        )

        # Path entry and button
        input_layout = QHBoxLayout()
        
        self.path_entry = QLineEdit()
        self.path_entry.setPlaceholderText(
            "Select file..." if self.is_file else "Select directory..."
        )
        self.path_entry.setReadOnly(True)
        if default_path:
            self.path_entry.setText(default_path)
        self.path_entry.setStyleSheet(HungerRushTheme.get_input_style())
        
        browse_button = QPushButton("Browse")
        browse_button.setStyleSheet(HungerRushTheme.get_button_style())
        browse_button.clicked.connect(self._browse)
        
        input_layout.addWidget(self.path_entry)
        input_layout.addWidget(browse_button)
        
        layout.addWidget(title_label)
        layout.addLayout(input_layout)

    def _browse(self) -> None:
        """Open file/directory browser dialog."""
        if self.is_file:
            if self.file_types:
                file_filter = f"Images ({' '.join(f'*{ext}' for ext in self.file_types)})"
            else:
                file_filter = "All Files (*.*)"
            path = QFileDialog.getOpenFileName(self, "Select File", "", file_filter)[0]
        else:
            path = QFileDialog.getExistingDirectory(self, "Select Directory")
            
        if path:
            self.set_path(path)

    def set_path(self, path: str) -> None:
        """Set the current path."""
        self.path_entry.setText(path)
        self.path_changed.emit(path)

    def get_path(self) -> str:
        """Get the current path."""
        return self.path_entry.text()

# src/ui/components/status_bar.py
"""Status bar widget implementation."""
from PySide6.QtWidgets import QFrame, QVBoxLayout, QProgressBar, QLabel
from src.ui.theme.manager import HungerRushTheme

class StatusBar(QFrame):
    """Widget for showing progress and status updates."""
    
    def __init__(self):
        """Initialize the status bar."""
        super().__init__()
        self._setup_ui()

    def _setup_ui(self) -> None:
        """Set up the user interface."""
        layout = QVBoxLayout(self)
        layout.setSpacing(10)

        # Progress bar
        self.progress_bar = QProgressBar()
        self.progress_bar.setStyleSheet(
            f"QProgressBar {{"
            f"    border: 1px solid {HungerRushTheme.COLORS['label_color']};"
            f"    border-radius: 2px;"
            f"    text-align: center;"
            f"    height: 20px;"
            f"}}"
            f"QProgressBar::chunk {{"
            f"    background-color: {HungerRushTheme.COLORS['button_color']};"
            f"}}"
        )
        
        # Status label
        self.status_label = QLabel("Ready")
        self.status_label.setStyleSheet(
            f"color: {HungerRushTheme.COLORS['label_color']};"
        )
        
        layout.addWidget(self.progress_bar)
        layout.addWidget(self.status_label)

    def update_progress(self, value: int, max_value: int, message: str = "") -> None:
        """Update progress bar and message."""
        self.progress_bar.setMaximum(max_value)
        self.progress_bar.setValue(value)
        if message:
            self.status_label.setText(message)

    def show_error(self, message: str) -> None:
        """Show error message."""
        self.status_label.setStyleSheet(
            f"color: {HungerRushTheme.COLORS['error_color']};"
            f"font-weight: bold;"
        )
        self.status_label.setText(message)

    def show_success(self, message: str) -> None:
        """Show success message."""
        self.status_label.setStyleSheet(
            f"color: {HungerRushTheme.COLORS['success_color']};"
            f"font-weight: bold;"
        )
        self.status_label.setText(message)

# src/ui/components/format